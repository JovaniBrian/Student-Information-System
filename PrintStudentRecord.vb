Imports System.Data.SqlClient
Public Class PrintStudentRecord

    Private Sub PrintStudentRecord_Load(sender As Object, e As EventArgs) Handles MyBase.Load
        Module1.connectme()
        Try
            sqlds.Clear()
            strsql = "SELECT  ev.[lrn],[fullname],[dateofbirth],[sex],[birthplace],[town],[brgy],[parent],[occupation],[parentaddress],[elemschool],[yeargrad],[genave],[classifiedgrade7],[totalyearsgrade7],[yeargrade7],[sectiongrade7],[schoolgrade7],[schoolyeargrade7],[cs1filipinograde7],[cs2filipinograde7],[cs3filipinograde7],[cs4filipinograde7],[filipinofinalratinggrade7],[filipinoactiontakengrade7],[filipinocreditgrade7],[filipinoecagrade7],[cs1englishgrade7],[cs2englishgrade7],[cs3englishgrade7],[cs4englishgrade7],[englishfinalratinggrade7],[englishactiontakengrade7],[englishcreditgrade7],[englishecagrade7],[cs1mathgrade7],[cs2mathgrade7],[cs3mathgrade7],[cs4mathgrade7],[mathfinalratinggrade7],[mathactiontakengrade7],[mathcreditgrade7],[mathecagrade7],[cs1sciencegrade7],[cs2sciencegrade7],[cs3sciencegrade7],[cs4sciencegrade7],[sciencefinalratinggrade7],[scienceactiontakengrade7],[sciencecreditgrade7],[scienceecagrade7],[cs1apgrade7],[cs2apgrade7],[cs3apgrade7],[cs4apgrade7],[apfinalratinggrade7],[apactiontakengrade7],[apcreditgrade7],[apecagrade7],[cs1espgrade7],[cs2espgrade7],[cs3espgrade7],[cs4espgrade7],[espfinalratinggrade7],[espactiontakengrade7],[espcreditgrade7],[especagrade7],[cs1tlegrade7],[cs2tlegrade7],[cs3tlegrade7],[cs4tlegrade7],[tlefinalratinggrade7],[tleactiontakengrade7],[tlecreditgrade7],[tleecagrade7],[cs1mapehgrade7],[cs2mapehgrade7],[cs3mapehgrade7],[cs4mapehgrade7],[mapehfinalratinggrade7],[mapehactiontakengrade7],[mapehcreditgrade7],[mapehecagrade7],[cs1musicgrade7],[cs2musicgrade7],[cs3musicgrade7],[cs4musicgrade7],[musicfinalratinggrade7],[musicactiontakengrade7],[musiccreditgrade7],[musicecagrade7],[cs1artsgrade7],[cs2artsgrade7],[cs3artsgrade7],[cs4artsgrade7],[artsfinalratinggrade7],[artsactiontakengrade7],[artscreditgrade7],[artsecagrade7],[cs1pegrade7],[cs2pegrade7],[cs3pegrade7],[cs4pegrade7],[pefinalratinggrade7],[peactiontakengrade7],[pecreditgrade7],[peecagrade7],[cs1healthgrade7],[cs2healthgrade7],[cs3healthgrade7],[cs4healthgrade7],[healthfinalratinggrade7],[healthactiontakengrade7],[healthcreditgrade7],[healthecagrade7],[averagegrade7],[averageactiontakengrade7],[averagecreditgrade7],[classifiedgrade8],[totalyearsgrade8],[yeargrade8],[sectiongrade8],[schoolgrade8],[schoolyeargrade8],[cs1filipinograde8],[cs2filipinograde8],[cs3filipinograde8],[cs4filipinograde8],[filipinofinalratinggrade8],[filipinoactiontakengrade8],[filipinocreditgrade8],[filipinoecagrade8],[cs1englishgrade8],[cs2englishgrade8],[cs3englishgrade8],[cs4englishgrade8],[englishfinalratinggrade8],[englishactiontakengrade8],[englishcreditgrade8],[englishecagrade8],[cs1mathgrade8],[cs2mathgrade8],[cs3mathgrade8],[cs4mathgrade8],[mathfinalratinggrade8],[mathactiontakengrade8],[mathcreditgrade8],[mathecagrade8],[cs1sciencegrade8],[cs2sciencegrade8],[cs3sciencegrade8],[cs4sciencegrade8],[sciencefinalratinggrade8],[scienceactiontakengrade8],[sciencecreditgrade8],[scienceecagrade8],[cs1apgrade8],[cs2apgrade8],[cs3apgrade8],[cs4apgrade8],[apfinalratinggrade8],[apactiontakengrade8],[apcreditgrade8],[apecagrade8],[cs1espgrade8],[cs2espgrade8],[cs3espgrade8],[cs4espgrade8],[espfinalratinggrade8],[espactiontakengrade8],[espcreditgrade8],[especagrade8],[cs1tlegrade8],[cs2tlegrade8],[cs3tlegrade8],[cs4tlegrade8],[tlefinalratinggrade8],[tleactiontakengrade8],[tlecreditgrade8],[tleecagrade8],[cs1mapehgrade8],[cs2mapehgrade8],[cs3mapehgrade8],[cs4mapehgrade8],[mapehfinalratinggrade8],[mapehactiontakengrade8],[mapehcreditgrade8],[mapehecagrade8],[cs1musicgrade8],[cs2musicgrade8],[cs3musicgrade8],[cs4musicgrade8],[musicfinalratinggrade8],[musicactiontakengrade8],[musiccreditgrade8],[musicecagrade8],[cs1artsgrade8],[cs2artsgrade8],[cs3artsgrade8],[cs4artsgrade8],[artsfinalratinggrade8],[artsactiontakengrade8],[artscreditgrade8],[artsecagrade8],[cs1pegrade8],[cs2pegrade8],[cs3pegrade8],[cs4pegrade8],[pefinalratinggrade8],[peactiontakengrade8],[pecreditgrade8],[peecagrade8],[cs1healthgrade8],[cs2healthgrade8],[cs3healthgrade8],[cs4healthgrade8],[healthfinalratinggrade8],[healthactiontakengrade8],[healthcreditgrade8],[healthecagrade8],[averagegrade8],[averageactiontakengrade8],[averagecreditgrade8],[classifiedgrade9],[totalyearsgrade9],[yeargrade9],[sectiongrade9],[schoolgrade9],[schoolyeargrade9],[cs1filipinograde9],[cs2filipinograde9],[cs3filipinograde9],[cs4filipinograde9],[filipinofinalratinggrade9],[filipinoactiontakengrade9],[filipinocreditgrade9],[filipinoecagrade9],[cs1englishgrade9],[cs2englishgrade9],[cs3englishgrade9],[cs4englishgrade9],[englishfinalratinggrade9],[englishactiontakengrade9],[englishcreditgrade9],[englishecagrade9],[cs1mathgrade9],[cs2mathgrade9],[cs3mathgrade9],[cs4mathgrade9],[mathfinalratinggrade9],[mathactiontakengrade9],[mathcreditgrade9],[mathecagrade9],[cs1sciencegrade9],[cs2sciencegrade9],[cs3sciencegrade9],[cs4sciencegrade9],[sciencefinalratinggrade9],[scienceactiontakengrade9],[sciencecreditgrade9],[scienceecagrade9],[cs1apgrade9],[cs2apgrade9],[cs3apgrade9],[cs4apgrade9],[apfinalratinggrade9],[apactiontakengrade9],[apcreditgrade9],[apecagrade9],[cs1espgrade9],[cs2espgrade9],[cs3espgrade9],[cs4espgrade9],[espfinalratinggrade9],[espactiontakengrade9],[espcreditgrade9],[especagrade9],[cs1tlegrade9],[cs2tlegrade9],[cs3tlegrade9],[cs4tlegrade9],[tlefinalratinggrade9],[tleactiontakengrade9],[tlecreditgrade9],[tleecagrade9],[cs1mapehgrade9],[cs2mapehgrade9],[cs3mapehgrade9],[cs4mapehgrade9],[mapehfinalratinggrade9],[mapehactiontakengrade9],[mapehcreditgrade9],[mapehecagrade9],[cs1musicgrade9],[cs2musicgrade9],[cs3musicgrade9],[cs4musicgrade9],[musicfinalratinggrade9],[musicactiontakengrade9],[musiccreditgrade9],[musicecagrade9],[cs1artsgrade9],[cs2artsgrade9],[cs3artsgrade9],[cs4artsgrade9],[artsfinalratinggrade9],[artsactiontakengrade9],[artscreditgrade9],[artsecagrade9],[cs1pegrade9],[cs2pegrade9],[cs3pegrade9],[cs4pegrade9],[pefinalratinggrade9],[peactiontakengrade9],[pecreditgrade9],[peecagrade9],[cs1healthgrade9],[cs2healthgrade9],[cs3healthgrade9],[cs4healthgrade9],[healthfinalratinggrade9],[healthactiontakengrade9],[healthcreditgrade9],[healthecagrade9],[averagegrade9],[averageactiontakengrade9],[averagecreditgrade9],[classifiedgrade10],[totalyearsgrade10],[yeargrade10],[sectiongrade10],[schoolgrade10],[schoolyeargrade10],[cs1filipinograde10],[cs2filipinograde10],[cs3filipinograde10],[cs4filipinograde10],[filipinofinalratinggrade10],[filipinoactiontakengrade10],[filipinocreditgrade10],[filipinoecagrade10],[cs1englishgrade10],[cs2englishgrade10],[cs3englishgrade10],[cs4englishgrade10],[englishfinalratinggrade10],[englishactiontakengrade10],[englishcreditgrade10],[englishecagrade10],[cs1mathgrade10],[cs2mathgrade10],[cs3mathgrade10],[cs4mathgrade10],[mathfinalratinggrade10],[mathactiontakengrade10],[mathcreditgrade10],[mathecagrade10],[cs1sciencegrade10],[cs2sciencegrade10],[cs3sciencegrade10],[cs4sciencegrade10],[sciencefinalratinggrade10],[scienceactiontakengrade10],[sciencecreditgrade10],[scienceecagrade10],[cs1apgrade10],[cs2apgrade10],[cs3apgrade10],[cs4apgrade10],[apfinalratinggrade10],[apactiontakengrade10],[apcreditgrade10],[apecagrade10],[cs1espgrade10],[cs2espgrade10],[cs3espgrade10],[cs4espgrade10],[espfinalratinggrade10],[espactiontakengrade10],[espcreditgrade10],[especagrade10],[cs1tlegrade10],[cs2tlegrade10],[cs3tlegrade10],[cs4tlegrade10],[tlefinalratinggrade10],[tleactiontakengrade10],[tlecreditgrade10],[tleecagrade10],[cs1mapehgrade10],[cs2mapehgrade10],[cs3mapehgrade10],[cs4mapehgrade10],[mapehfinalratinggrade10],[mapehactiontakengrade10],[mapehcreditgrade10],[mapehecagrade10],[cs1musicgrade10],[cs2musicgrade10],[cs3musicgrade10],[cs4musicgrade10],[musicfinalratinggrade10],[musicactiontakengrade10],[musiccreditgrade10],[musicecagrade10],[cs1artsgrade10],[cs2artsgrade10],[cs3artsgrade10],[cs4artsgrade10],[artsfinalratinggrade10],[artsactiontakengrade10],[artscreditgrade10],[artsecagrade10],[cs1pegrade10],[cs2pegrade10],[cs3pegrade10],[cs4pegrade10],[pefinalratinggrade10],[peactiontakengrade10],[pecreditgrade10],[peecagrade10],[cs1healthgrade10],[cs2healthgrade10],[cs3healthgrade10],[cs4healthgrade10],[healthfinalratinggrade10],[healthactiontakengrade10],[healthcreditgrade10],[healthecagrade10],[averagegrade10],[averageactiontakengrade10],[averagecreditgrade10],[dsjungrade7],[dsjulgrade7],[dsauggrade7],[dssepgrade7],[dsoctgrade7],[dsnovgrade7],[dsdecgrade7],[dsjangrade7],[dsfebgrade7],[dsmargrade7],[dsaprgrade7],[dstotalgrade7],[dpjungrade7],[dpjulgrade7],[dpauggrade7],[dpsepgrade7],[dpoctgrade7],[dpnovgrade7],[dpdecgrade7],[dpjangrade7],[dpfebgrade7],[dpmargrade7],[dpaprgrade7],[dptotalgrade7],[advisergrade7],[advancedunitsgrade7],[lackunitsgrade7],[dsjungrade8],[dsjulgrade8],[dsauggrade8],[dssepgrade8],[dsoctgrade8],[dsnovgrade8],[dsdecgrade8],[dsjangrade8],[dsfebgrade8],[dsmargrade8],[dsaprgrade8],[dstotalgrade8],[dpjungrade8],[dpjulgrade8],[dpauggrade8],[dpsepgrade8],[dpoctgrade8],[dpnovgrade8],[dpdecgrade8],[dpjangrade8],[dpfebgrade8],[dpmargrade8],[dpaprgrade8],[dptotalgrade8],[advisergrade8],[advancedunitsgrade8],[lackunitsgrade8],[dsjungrade9],[dsjulgrade9],[dsauggrade9],[dssepgrade9],[dsoctgrade9],[dsnovgrade9],[dsdecgrade9],[dsjangrade9],[dsfebgrade9],[dsmargrade9],[dsaprgrade9],[dstotalgrade9],[dpjungrade9],[dpjulgrade9],[dpauggrade9],[dpsepgrade9],[dpoctgrade9],[dpnovgrade9],[dpdecgrade9],[dpjangrade9],[dpfebgrade9],[dpmargrade9],[dpaprgrade9],[dptotalgrade9],[advisergrade9],[advancedunitsgrade9],[lackunitsgrade9],[dsjungrade10],[dsjulgrade10],[dsauggrade10],[dssepgrade10],[dsoctgrade10],[dsnovgrade10],[dsdecgrade10],[dsjangrade10],[dsfebgrade10],[dsmargrade10],[dsaprgrade10],[dstotalgrade10],[dpjungrade10],[dpjulgrade10],[dpauggrade10],[dpsepgrade10],[dpoctgrade10],[dpnovgrade10],[dpdecgrade10],[dpjangrade10],[dpfebgrade10],[dpmargrade10],[dpaprgrade10],[dptotalgrade10],[advisergrade10],[advancedunitsgrade10],[lackunitsgrade10] FROM   [studinfoTbl] as ev JOIN  [studrecordgrade7Tbl] as srg7 ON ev.lrn = srg7.lrn JOIN  [studrecordgrade8Tbl] as srg8 ON ev.lrn = srg8.lrn  JOIN  [studrecordgrade9Tbl] as srg9 ON ev.lrn = srg9.lrn  JOIN  [studrecordgrade10Tbl] as srg10 ON ev.lrn = srg10.lrn  JOIN  [studattendancegrade7Tbl] as sag7 ON ev.lrn = sag7.lrn JOIN  [studattendancegrade8Tbl] as sag8 ON ev.lrn = sag8.lrn  JOIN  [studattendancegrade9Tbl] as sag9 ON ev.lrn = sag9.lrn  JOIN  [studattendancegrade10Tbl] as sag10 ON ev.lrn = sag10.lrn where ev.lrn = '" & StudentInformationAndRecord.txtlrn.Text & "'"
            Dim sqlda As New SqlDataAdapter(strsql, sqlconn)
            sqlda.Fill(sqlds, "table1")
            strreportname = "Form137A"
            Dim strreportpath As String = Application.StartupPath & "\" & strreportname & ".rpt"
            If Not IO.File.Exists(strreportpath) Then
                Throw (New Exception("unable to Locate file: " & vbCrLf & strreportpath))
                Exit Sub
            End If
            Dim rptdocument As New CrystalDecisions.CrystalReports.Engine.ReportDocument
            rptdocument.Load(strreportpath)
            rptdocument.SetDataSource(sqlds.Tables(0))
            rptdocument.SetDatabaseLogon("jovanibrian", "jovani123")
            CrystalReportViewer1.ReportSource = rptdocument
            CrystalReportViewer1.Refresh()
        Catch ex As Exception
            MsgBox(ex.Message)
        End Try
    End Sub

    Private Sub btnreturn_Click(sender As Object, e As EventArgs) Handles btnreturn.Click
        Me.Close()
        StudentInformationAndRecord.Show()
        StudentInformationAndRecord.MdiParent = MainForm
    End Sub
End Class